import React, { useMemo, useRef, useState } from "react";

// NOTE: This is a single-file React prototype for the WokRock website.
// It focuses on UX flow, multilingual UI (DE default), responsive design,
// interactive catering package builder, à la carte ordering, and a clean, premium feel.
// TailwindCSS classes are used throughout. You can paste this into a Next.js/CRA project.
// PDF export relies on jsPDF + html2canvas; install them in your project for full functionality:
//   npm i jspdf html2canvas
// Images are placeholders; replace with your dish images.

// --- Utility: currency formatter (CHF) ---
const chf = (n) => new Intl.NumberFormat(undefined, { style: "currency", currency: "CHF", maximumFractionDigits: 0 }).format(n);

// --- Language packs ---
const i18n = {
  de: {
    langLabel: "Deutsch",
    nav: { home: "Home", menu: "Einzeln bestellen", packages: "Pakete", about: "Über uns", contact: "Kontakt" },
    heroTitle: "WokRock – Frisch. Hochwertig. Köstlich.",
    heroSubtitle: "Premium-Party-Catering in der ganzen Schweiz (10–200 Personen)",
    ctaPackages: "Pakete zusammenstellen",
    ctaMenu: "Einzeln bestellen",
    trust: {
      a: "Sauber & zuverlässig",
      b: "Frische Zutaten",
      c: "Schnelle Lieferung",
      d: "Für Events von 10–200 Personen",
    },
    sectionTitles: {
      builder: "Schnellrechner & Paket-Konfigurator",
      menu: "Einzelgerichte bestellen (À la carte)",
      gallery: "Beliebte Gerichte",
      about: "Warum WokRock?",
      checkout: "Bestelldaten & Lieferung",
    },
    peopleInput: "Teilnehmerzahl",
    chooseRange: "Wähle die Personenspanne:",
    pkg: {
      standard: "Standard",
      deluxe: "Deluxe",
      deluxePlus: "Deluxe Plus",
      selectPkg: "Paket wählen",
      includes: "Enthält",
      starter: "Vorspeise",
      starters: "Vorspeisen",
      hot: "Warme Gerichte",
      dessert: "Dessert",
      desserts: "Desserts",
      chooseItems: "Gerichte auswählen",
    },
    pricePerPerson: "Preis/Person",
    total: "Zwischensumme",
    addToOrder: "Zur Bestellung hinzufügen",
    yourSelection: "Ihre Auswahl",
    clear: "Zurücksetzen",
    menuAdd: "Hinzufügen",
    menuQty: "Menge",
    downloadPDF: "Bestellübersicht als PDF",
    emailOrder: "Per E‑Mail an WokRock senden",
    orCall: "Oder rufen Sie uns an:",
    phone: "+41 79 000 00 00",
    delivery: {
      date: "Lieferdatum",
      time: "Lieferzeit",
      address: "Lieferadresse",
      notes: "Bemerkungen (Allergien, Zugang etc.)",
    },
    orderType: { package: "Paketbestellung", ala: "Einzelbestellung" },
    langSwitch: "Sprache",
    menuView: { selected: "Ausgewählt", empty: "Noch nichts ausgewählt" },
  },
  en: {
    langLabel: "English",
    nav: { home: "Home", menu: "À la carte", packages: "Packages", about: "About", contact: "Contact" },
    heroTitle: "WokRock – Fresh. Premium. Delicious.",
    heroSubtitle: "Party catering across Switzerland (10–200 guests)",
    ctaPackages: "Build a package",
    ctaMenu: "Order à la carte",
    trust: { a: "Clean & reliable", b: "Fresh ingredients", c: "Fast delivery", d: "Events for 10–200" },
    sectionTitles: { builder: "Quick Estimator & Package Builder", menu: "Order À la carte", gallery: "Popular Dishes", about: "Why WokRock?", checkout: "Order & Delivery Details" },
    peopleInput: "Guest count",
    chooseRange: "Choose a guest range:",
    pkg: { standard: "Standard", deluxe: "Deluxe", deluxePlus: "Deluxe Plus", selectPkg: "Choose package", includes: "Includes", starter: "Starter", starters: "Starters", hot: "Hot dishes", dessert: "Dessert", desserts: "Desserts", chooseItems: "Pick dishes" },
    pricePerPerson: "Price/person",
    total: "Subtotal",
    addToOrder: "Add to order",
    yourSelection: "Your selection",
    clear: "Clear",
    menuAdd: "Add",
    menuQty: "Qty",
    downloadPDF: "Download order as PDF",
    emailOrder: "Send order by email",
    orCall: "Or call us:",
    phone: "+41 79 000 00 00",
    delivery: { date: "Delivery date", time: "Delivery time", address: "Delivery address", notes: "Notes (allergies, access, etc.)" },
    orderType: { package: "Package", ala: "À la carte" },
    langSwitch: "Language",
    menuView: { selected: "Selected", empty: "Nothing selected yet" },
  },
  zh: {
    langLabel: "中文",
    nav: { home: "首页", menu: "单独订购", packages: "聚会套餐", about: "关于我们", contact: "联系" },
    heroTitle: "WokRock — 干净·高品质·美味",
    heroSubtitle: "覆盖全瑞士的聚会餐服务（10–200人）",
    ctaPackages: "开始配置套餐",
    ctaMenu: "单独点菜",
    trust: { a: "干净可靠", b: "新鲜食材", c: "快速配送", d: "10–200人活动" },
    sectionTitles: { builder: "快速估算与套餐配置", menu: "单独订购（À la carte）", gallery: "人气菜品", about: "为什么选择 WokRock?", checkout: "订单与配送信息" },
    peopleInput: "聚会人数",
    chooseRange: "选择人数范围：",
    pkg: { standard: "普通套餐", deluxe: "豪华套餐", deluxePlus: "豪华套餐Plus", selectPkg: "选择套餐", includes: "包含", starter: "前餐", starters: "前餐", hot: "热菜", dessert: "甜点", desserts: "甜点", chooseItems: "选择菜品" },
    pricePerPerson: "每人价格",
    total: "小计",
    addToOrder: "加入订单",
    yourSelection: "已选清单",
    clear: "清空",
    menuAdd: "添加",
    menuQty: "数量",
    downloadPDF: "下载PDF清单",
    emailOrder: "发送到邮箱",
    orCall: "或直接电话：",
    phone: "+41 79 000 00 00",
    delivery: { date: "配送日期", time: "配送时间", address: "配送地址", notes: "备注（过敏、门禁等）" },
    orderType: { package: "套餐订购", ala: "单独订购" },
    langSwitch: "语言",
    menuView: { selected: "已选", empty: "暂未选择" },
  },
};

// --- Menu data (sample) ---
const DISHES = {
  starters: [
    { id: "st1", name: { de: "Edamame mit Meersalz", en: "Edamame with sea salt", zh: "海盐毛豆" }, img: "/img/edamame.jpg" },
    { id: "st2", name: { de: "Sommerrollen", en: "Summer rolls", zh: "越式春卷（冷）" }, img: "/img/summer-rolls.jpg" },
    { id: "st3", name: { de: "Sesam-Gurken", en: "Sesame cucumbers", zh: "芝麻拍黄瓜" }, img: "/img/cucumber.jpg" },
  ],
  hot: [
    { id: "h1", name: { de: "Rind Teriyaki", en: "Beef Teriyaki", zh: "照烧牛肉" }, img: "/img/teriyaki-beef.jpg" },
    { id: "h2", name: { de: "Huhn Kung Pao", en: "Kung Pao Chicken", zh: "宫保鸡丁" }, img: "/img/kungpao.jpg" },
    { id: "h3", name: { de: "Tofu Gemüse Wok (vegan)", en: "Tofu veggie wok (vegan)", zh: "素什锦豆腐（纯素）" }, img: "/img/tofu-wok.jpg" },
    { id: "h4", name: { de: "Lachs Thai-Curry", en: "Salmon Thai curry", zh: "三文鱼泰式咖喱" }, img: "/img/salmon-curry.jpg" },
  ],
  desserts: [
    { id: "d1", name: { de: "Mango Sticky Rice", en: "Mango sticky rice", zh: "芒果糯米饭" }, img: "/img/mango.jpg" },
    { id: "d2", name: { de: "Matcha-Mousse", en: "Matcha mousse", zh: "抹茶慕斯" }, img: "/img/matcha.jpg" },
    { id: "d3", name: { de: "Sesamkugeln", en: "Sesame balls", zh: "芝麻球" }, img: "/img/sesame-balls.jpg" },
  ],
};

// --- Pricing & rules by party size ---
const RULES = [
  {
    range: "10–20",
    min: 10,
    max: 20,
    prices: { standard: 25, deluxe: 35, deluxePlus: 50 },
    picks: {
      standard: { starters: 1, hot: 2, desserts: 1 },
      deluxe: { starters: 1, hot: 3, desserts: 1 },
      deluxePlus: { starters: 2, hot: 3, desserts: 2 },
    },
  },
  {
    range: "21–50",
    min: 21,
    max: 50,
    prices: { standard: 25, deluxe: 32, deluxePlus: 45 },
    picks: {
      standard: { starters: 2, hot: 2, desserts: 2 },
      deluxe: { starters: 2, hot: 4, desserts: 3 },
      deluxePlus: { starters: 3, hot: 5, desserts: 3 },
    },
  },
  {
    range: "50+",
    min: 51,
    max: 10000,
    prices: { standard: 23, deluxe: 30, deluxePlus: 40 },
    picks: {
      standard: { starters: 2, hot: 2, desserts: 2 },
      deluxe: { starters: 2, hot: 4, desserts: 3 },
      deluxePlus: { starters: 3, hot: 5, desserts: 3 },
    },
  },
];

const LANGS = ["de", "en", "zh"];

function SectionTitle({ children }) {
  return (
    <h2 className="text-2xl md:text-3xl font-semibold tracking-tight mb-4">{children}</h2>
  );
}

function Pill({ children }) {
  return (
    <span className="inline-flex items-center px-3 py-1 rounded-full text-xs md:text-sm border border-white/40 bg-white/10 backdrop-blur-sm">
      {children}
    </span>
  );
}

function DishCard({ dish, lang, onAdd }) {
  return (
    <div className="group rounded-2xl p-3 border shadow-sm hover:shadow-lg transition bg-white/60 backdrop-blur">
      <div className="aspect-[4/3] w-full overflow-hidden rounded-xl mb-3 bg-gray-100">
        <img src={dish.img} alt={dish.name[lang]} className="w-full h-full object-cover group-hover:scale-[1.02] transition" />
      </div>
      <div className="flex items-center justify-between gap-2">
        <div className="font-medium text-gray-800">{dish.name[lang]}</div>
        {onAdd && (
          <button onClick={onAdd} className="px-3 py-1.5 rounded-xl text-sm bg-black text-white hover:bg-gray-800">
            +
          </button>
        )}
      </div>
    </div>
  );
}

function Selector({ label, options, value, onChange }) {
  return (
    <label className="block">
      <span className="text-sm text-gray-600">{label}</span>
      <select value={value} onChange={(e) => onChange(e.target.value)} className="mt-1 w-full rounded-xl border px-3 py-2 bg-white">
        <option value="">—</option>
        {options.map((o) => (
          <option key={o.id} value={o.id}>{o.label}</option>
        ))}
      </select>
    </label>
  );
}

export default function WokRockSite() {
  const [lang, setLang] = useState("de");
  const t = i18n[lang];

  const [guestCount, setGuestCount] = useState(20);
  const [pkgKey, setPkgKey] = useState(null); // "standard" | "deluxe" | "deluxePlus"
  const [pkgSelections, setPkgSelections] = useState({ starters: [], hot: [], desserts: [] });

  const [cart, setCart] = useState([]); // {id, name, qty, price}
  const [orderType, setOrderType] = useState("package"); // "package" | "ala"

  const [deliveryDate, setDeliveryDate] = useState("");
  const [deliveryTime, setDeliveryTime] = useState("");
  const [address, setAddress] = useState("");
  const [notes, setNotes] = useState("");

  const receiptRef = useRef(null);

  const rule = useMemo(() => RULES.find(r => guestCount >= r.min && guestCount <= r.max) || RULES[0], [guestCount]);

  const picksRequired = useMemo(() => (pkgKey ? rule.picks[pkgKey] : { starters: 0, hot: 0, desserts: 0 }), [rule, pkgKey]);
  const pricePerPerson = useMemo(() => (pkgKey ? rule.prices[pkgKey] : 0), [rule, pkgKey]);
  const packageSubtotal = useMemo(() => (pkgKey ? pricePerPerson * guestCount : 0), [pricePerPerson, guestCount, pkgKey]);
  const alaSubtotal = useMemo(() => cart.reduce((s, it) => s + it.price * it.qty, 0), [cart]);

  const total = (orderType === "package" ? packageSubtotal : alaSubtotal);

  // Build options for selectors
  const dishOptions = (list) => list.map(d => ({ id: d.id, label: d.name[lang] }));

  const togglePkgItem = (cat, id) => {
    setPkgSelections(prev => {
      const exists = prev[cat].includes(id);
      const arr = exists ? prev[cat].filter(x => x !== id) : [...prev[cat], id];
      return { ...prev, [cat]: arr };
    });
  };

  const isPkgValid = () => {
    return ["starters", "hot", "desserts"].every((cat) => (pkgSelections[cat]?.length || 0) === (picksRequired[cat] || 0));
  };

  const addPackageToOrder = () => {
    if (!pkgKey || !isPkgValid()) return;
    const line = {
      id: `pkg-${Date.now()}`,
      name: `${t.orderType.package}: ${t.pkg[pkgKey] || pkgKey} (${guestCount}p @ ${chf(pricePerPerson)})`,
      qty: 1,
      price: pricePerPerson * guestCount,
      meta: { pkgKey, guestCount, selection: pkgSelections },
    };
    setCart((c) => [...c, line]);
  };

  const addDish = (dish, price = 12) => {
    setCart((c) => {
      const idx = c.findIndex((x) => x.id === dish.id);
      if (idx >= 0) {
        const copy = [...c];
        copy[idx] = { ...copy[idx], qty: copy[idx].qty + 1 };
        return copy;
      }
      return [...c, { id: dish.id, name: dish.name[lang], qty: 1, price }];
    });
  };

  const updateQty = (id, qty) => {
    setCart((c) => c.map((x) => (x.id === id ? { ...x, qty: Math.max(0, qty) } : x)).filter((x) => x.qty > 0));
  };

  const clearAll = () => {
    setCart([]);
    setPkgKey(null);
    setPkgSelections({ starters: [], hot: [], desserts: [] });
  };

  const selectionSummaryLines = () => {
    if (orderType === "package" && pkgKey) {
      const labels = (ids) => ids.map((id) => {
        const item = [...DISHES.starters, ...DISHES.hot, ...DISHES.desserts].find((d) => d.id === id);
        return item ? item.name[lang] : id;
      }).join(", ");
      return [
        `${t.orderType.package} — ${t.pkg[pkgKey]} — ${guestCount}p — ${chf(pricePerPerson)} /p` ,
        `${t.pkg.starters}: ${labels(pkgSelections.starters)}`,
        `${t.pkg.hot}: ${labels(pkgSelections.hot)}`,
        `${t.pkg.desserts}: ${labels(pkgSelections.desserts)}`,
      ];
    }
    return cart.map((it) => `${it.name} × ${it.qty} — ${chf(it.price * it.qty)}`);
  };

  const handleDownloadPDF = async () => {
    try {
      const { jsPDF } = await import("jspdf");
      const html2canvas = (await import("html2canvas")).default;
      const node = receiptRef.current;
      const canvas = await html2canvas(node, { scale: 2, backgroundColor: "#ffffff" });
      const imgData = canvas.toDataURL("image/png");
      const pdf = new jsPDF({ unit: "pt", format: "a4" });
      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      const imgWidth = pageWidth - 80;
      const imgHeight = (canvas.height * imgWidth) / canvas.width;
      pdf.addImage(imgData, "PNG", 40, 40, imgWidth, Math.min(imgHeight, pageHeight - 80));
      pdf.save(`WokRock_Bestellung_${new Date().toISOString().slice(0,10)}.pdf`);
    } catch (e) {
      alert("PDF export requires jsPDF + html2canvas.");
    }
  };

  const emailBody = encodeURIComponent([
    "WokRock Bestellung",
    "",
    `Typ: ${orderType === "package" ? t.orderType.package : t.orderType.ala}`,
    ...selectionSummaryLines(),
    "",
    `${t.delivery.date}: ${deliveryDate}`,
    `${t.delivery.time}: ${deliveryTime}`,
    `${t.delivery.address}: ${address}`,
    `${t.delivery.notes}: ${notes}`,
    "",
    `Gesamtsumme / Total: ${chf(total)}`,
  ].join("\n"));

  const emailLink = `mailto:order@wokrock.ch?subject=${encodeURIComponent("WokRock Bestellung")}&body=${emailBody}`;

  return (
    <div className="min-h-screen bg-gradient-to-b from-emerald-50 via-white to-emerald-50 text-gray-900">
      {/* NAV */}
      <header className="sticky top-0 z-40 backdrop-blur bg-white/70 border-b">
        <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="w-9 h-9 rounded-2xl bg-emerald-500"></div>
            <div className="font-bold text-lg tracking-tight">WokRock</div>
          </div>
          <nav className="hidden md:flex items-center gap-6 text-sm">
            <a href="#builder" className="hover:opacity-70">{t.nav.packages}</a>
            <a href="#menu" className="hover:opacity-70">{t.nav.menu}</a>
            <a href="#about" className="hover:opacity-70">{t.nav.about}</a>
            <a href="#checkout" className="hover:opacity-70">{t.nav.contact}</a>
          </nav>
          <div className="flex items-center gap-2">
            <label className="sr-only">{t.langSwitch}</label>
            <select value={lang} onChange={(e) => setLang(e.target.value)} className="rounded-xl border px-2 py-1 bg-white text-sm">
              {LANGS.map((l) => (
                <option key={l} value={l}>{i18n[l].langLabel}</option>
              ))}
            </select>
          </div>
        </div>
      </header>

      {/* HERO */}
      <section className="relative overflow-hidden">
        <div className="absolute inset-0 -z-10 bg-[radial-gradient(circle_at_20%_20%,rgba(16,185,129,.25),transparent_40%),radial-gradient(circle_at_80%_0%,rgba(59,130,246,.2),transparent_35%),radial-gradient(circle_at_80%_80%,rgba(236,72,153,.2),transparent_35%)]"/>
        <div className="max-w-6xl mx-auto px-4 py-16 md:py-24 grid md:grid-cols-2 gap-8 items-center">
          <div>
            <h1 className="text-4xl md:text-5xl font-bold leading-tight tracking-tight">
              {t.heroTitle}
            </h1>
            <p className="mt-4 text-lg text-gray-700">{t.heroSubtitle}</p>
            <div className="mt-6 flex flex-wrap gap-3">
              <Pill>{t.trust.a}</Pill>
              <Pill>{t.trust.b}</Pill>
              <Pill>{t.trust.c}</Pill>
              <Pill>{t.trust.d}</Pill>
            </div>
            <div className="mt-8 flex flex-wrap gap-3">
              <a href="#builder" className="px-5 py-3 rounded-2xl bg-black text-white hover:bg-gray-800">{t.ctaPackages}</a>
              <a href="#menu" className="px-5 py-3 rounded-2xl bg-white border hover:bg-gray-50">{t.ctaMenu}</a>
            </div>
          </div>
          <div className="grid grid-cols-2 gap-3">
            <div className="aspect-[4/3] rounded-3xl bg-white/70 shadow overflow-hidden">
              <img src="/img/hero1.jpg" alt="dish" className="w-full h-full object-cover"/>
            </div>
            <div className="aspect-[4/3] rounded-3xl bg-white/70 shadow overflow-hidden translate-y-6">
              <img src="/img/hero2.jpg" alt="dish" className="w-full h-full object-cover"/>
            </div>
            <div className="aspect-[4/3] rounded-3xl bg-white/70 shadow overflow-hidden -translate-y-6">
              <img src="/img/hero3.jpg" alt="dish" className="w-full h-full object-cover"/>
            </div>
            <div className="aspect-[4/3] rounded-3xl bg-white/70 shadow overflow-hidden">
              <img src="/img/hero4.jpg" alt="dish" className="w-full h-full object-cover"/>
            </div>
          </div>
        </div>
      </section>

      {/* BUILDER */}
      <section id="builder" className="max-w-6xl mx-auto px-4 py-12">
        <SectionTitle>{t.sectionTitles.builder}</SectionTitle>

        <div className="grid lg:grid-cols-3 gap-6">
          {/* Left: Controls */}
          <div className="lg:col-span-2 p-4 md:p-6 rounded-3xl border bg-white/70 shadow-sm">
            <div className="grid md:grid-cols-3 gap-4 items-end">
              <label className="block">
                <span className="text-sm text-gray-600">{t.peopleInput}</span>
                <input type="number" min={10} max={9999} value={guestCount} onChange={(e) => setGuestCount(parseInt(e.target.value||"10"))} className="mt-1 w-full rounded-xl border px-3 py-2" />
              </label>

              <label className="block">
                <span className="text-sm text-gray-600">{t.chooseRange}</span>
                <select value={rule.range} onChange={(e)=>{
                  const val = e.target.value;
                  const r = RULES.find(x=>x.range===val);
                  if (r) setGuestCount(Math.max(r.min, Math.min(r.max<10000?r.max:Math.max(guestCount,r.min), guestCount)));
                }} className="mt-1 w-full rounded-xl border px-3 py-2">
                  {RULES.map(r => (<option key={r.range} value={r.range}>{r.range}</option>))}
                </select>
              </label>

              <label className="block">
                <span className="text-sm text-gray-600">{t.pkg.selectPkg}</span>
                <select value={pkgKey||""} onChange={(e)=>{ setPkgKey(e.target.value||null); setPkgSelections({ starters: [], hot: [], desserts: []}); }} className="mt-1 w-full rounded-xl border px-3 py-2">
                  <option value="">—</option>
                  <option value="standard">{t.pkg.standard} — {chf(rule.prices.standard)}</option>
                  <option value="deluxe">{t.pkg.deluxe} — {chf(rule.prices.deluxe)}</option>
                  <option value="deluxePlus">{t.pkg.deluxePlus} — {chf(rule.prices.deluxePlus)}</option>
                </select>
              </label>
            </div>

            {/* Pickers */}
            {pkgKey && (
              <div className="mt-6 grid md:grid-cols-3 gap-4">
                {["starters","hot","desserts"].map((cat) => (
                  <div key={cat} className="p-4 rounded-2xl border bg-white">
                    <div className="text-sm text-gray-600 mb-1">{t.pkg.chooseItems}</div>
                    <div className="font-medium mb-2">
                      {cat === "starters" ? t.pkg.starters : cat === "hot" ? t.pkg.hot : t.pkg.desserts}
                      <span className="text-xs text-gray-500 ml-2">({(picksRequired[cat]||0)} {lang==="en"?"req":"必选"})</span>
                    </div>
                    <div className="grid gap-2">
                      {(cat === "starters" ? DISHES.starters : cat === "hot" ? DISHES.hot : DISHES.desserts).map(d => {
                        const chosen = pkgSelections[cat].includes(d.id);
                        const disabled = !chosen && (pkgSelections[cat].length >= (picksRequired[cat]||0));
                        return (
                          <button key={d.id} onClick={()=>!disabled && togglePkgItem(cat, d.id)} className={`flex items-center gap-3 text-left p-2 rounded-xl border ${chosen?"bg-emerald-50 border-emerald-300":"bg-white hover:bg-gray-50"} ${disabled?"opacity-50 cursor-not-allowed":""}`}>
                            <img src={d.img} alt="" className="w-12 h-12 rounded-lg object-cover"/>
                            <div className="flex-1">
                              <div className="text-sm font-medium">{d.name[lang]}</div>
                              <div className="text-xs text-gray-500">{chosen ? (lang==="de"?"Ausgewählt":"已选") : ""}</div>
                            </div>
                            <div className="text-xs px-2 py-1 rounded-full border">{chosen?"✓":"+"}</div>
                          </button>
                        );
                      })}
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* Summary & Add */}
            <div className="mt-6 flex flex-wrap items-center justify-between gap-3">
              <div className="text-sm text-gray-600">
                {t.pricePerPerson}: {pkgKey ? chf(pricePerPerson) : "—"} · {t.total}: {pkgKey ? chf(packageSubtotal) : "—"}
              </div>
              <div className="flex gap-2">
                <button onClick={addPackageToOrder} disabled={!pkgKey || !isPkgValid()} className="px-4 py-2 rounded-xl bg-black text-white disabled:opacity-50">
                  {t.addToOrder}
                </button>
                <button onClick={clearAll} className="px-4 py-2 rounded-xl border bg-white">{t.clear}</button>
              </div>
            </div>
          </div>

          {/* Right: Cart */}
          <div className="p-4 md:p-6 rounded-3xl border bg-white/70 shadow-sm">
            <div className="font-semibold mb-3">{t.yourSelection}</div>
            {cart.length === 0 ? (
              <div className="text-sm text-gray-500">{t.menuView.empty}</div>
            ) : (
              <div className="space-y-3">
                {cart.map((it) => (
                  <div key={it.id} className="flex items-center justify-between gap-3">
                    <div className="flex-1">
                      <div className="text-sm font-medium">{it.name}</div>
                      <div className="text-xs text-gray-500">{chf(it.price)} × {it.qty}</div>
                    </div>
                    <div className="flex items-center gap-2">
                      <input type="number" min={0} value={it.qty} onChange={(e)=>updateQty(it.id, parseInt(e.target.value||"0"))} className="w-16 rounded-lg border px-2 py-1"/>
                      <div className="w-20 text-right text-sm">{chf(it.price * it.qty)}</div>
                    </div>
                  </div>
                ))}
                <div className="flex items-center justify-between border-t pt-2 mt-2">
                  <div className="text-sm text-gray-600">{t.total}</div>
                  <div className="font-semibold">{chf(total)}</div>
                </div>
              </div>
            )}
          </div>
        </div>
      </section>

      {/* A LA CARTE MENU */}
      <section id="menu" className="max-w-6xl mx-auto px-4 py-12">
        <SectionTitle>{t.sectionTitles.menu}</SectionTitle>
        <div className="grid md:grid-cols-3 gap-6">
          <div className="md:col-span-2 grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {[...DISHES.starters, ...DISHES.hot, ...DISHES.desserts].map((d) => (
              <DishCard key={d.id} dish={d} lang={lang} onAdd={() => addDish(d)} />
            ))}
          </div>
          <div className="p-4 md:p-6 rounded-3xl border bg-white/70 shadow-sm h-fit sticky top-24">
            <div className="font-semibold mb-3">{t.yourSelection}</div>
            {cart.length === 0 ? (
              <div className="text-sm text-gray-500">{t.menuView.empty}</div>
            ) : (
              <div className="space-y-3">
                {cart.map((it) => (
                  <div key={it.id} className="flex items-center justify-between gap-3">
                    <div className="flex-1">
                      <div className="text-sm font-medium">{it.name}</div>
                      <div className="text-xs text-gray-500">{t.menuQty}: {it.qty}</div>
                    </div>
                    <div className="flex items-center gap-2">
                      <input type="number" min={0} value={it.qty} onChange={(e)=>updateQty(it.id, parseInt(e.target.value||"0"))} className="w-16 rounded-lg border px-2 py-1"/>
                      <div className="w-20 text-right text-sm">{chf(it.price * it.qty)}</div>
                    </div>
                  </div>
                ))}
                <div className="flex items-center justify-between border-t pt-2 mt-2">
                  <div className="text-sm text-gray-600">{t.total}</div>
                  <div className="font-semibold">{chf(total)}</div>
                </div>
              </div>
            )}
          </div>
        </div>
      </section>

      {/* GALLERY */}
      <section className="max-w-6xl mx-auto px-4 py-12">
        <SectionTitle>{t.sectionTitles.gallery}</SectionTitle>
        <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-3">
          {[...DISHES.starters, ...DISHES.hot, ...DISHES.desserts].slice(0,8).map((d) => (
            <div key={d.id} className="rounded-2xl overflow-hidden border bg-white">
              <img src={d.img} alt={d.name[lang]} className="w-full h-40 object-cover"/>
              <div className="p-3 text-sm font-medium">{d.name[lang]}</div>
            </div>
          ))}
        </div>
      </section>

      {/* ABOUT */}
      <section id="about" className="max-w-6xl mx-auto px-4 py-12">
        <SectionTitle>{t.sectionTitles.about}</SectionTitle>
        <div className="grid md:grid-cols-3 gap-6">
          {[t.trust.a, t.trust.b, t.trust.c].map((txt, i) => (
            <div key={i} className="p-6 rounded-3xl border bg-white/70 shadow-sm">
              <div className="text-lg font-semibold mb-2">{txt}</div>
              <p className="text-sm text-gray-600">WokRock steht für sauberes Arbeiten, hochwertige Zutaten und fein abgestimmte Rezepte. Unsere Küche ist auf Gruppen-Events optimiert – damit Ihr Anlass reibungslos und köstlich wird.</p>
            </div>
          ))}
        </div>
      </section>

      {/* CHECKOUT / CONTACT */}
      <section id="checkout" className="max-w-6xl mx-auto px-4 py-12">
        <SectionTitle>{t.sectionTitles.checkout}</SectionTitle>
        <div className="grid md:grid-cols-3 gap-6">
          <div className="md:col-span-2 p-4 md:p-6 rounded-3xl border bg-white/70 shadow-sm">
            <div className="grid sm:grid-cols-2 gap-4">
              <label className="block">
                <span className="text-sm text-gray-600">{t.delivery.date}</span>
                <input type="date" value={deliveryDate} onChange={(e)=>setDeliveryDate(e.target.value)} className="mt-1 w-full rounded-xl border px-3 py-2"/>
              </label>
              <label className="block">
                <span className="text-sm text-gray-600">{t.delivery.time}</span>
                <input type="time" value={deliveryTime} onChange={(e)=>setDeliveryTime(e.target.value)} className="mt-1 w-full rounded-xl border px-3 py-2"/>
              </label>
              <label className="sm:col-span-2 block">
                <span className="text-sm text-gray-600">{t.delivery.address}</span>
                <input type="text" value={address} onChange={(e)=>setAddress(e.target.value)} placeholder="Strasse Nr., PLZ Ort" className="mt-1 w-full rounded-xl border px-3 py-2"/>
              </label>
              <label className="sm:col-span-2 block">
                <span className="text-sm text-gray-600">{t.delivery.notes}</span>
                <textarea value={notes} onChange={(e)=>setNotes(e.target.value)} rows={3} className="mt-1 w-full rounded-xl border px-3 py-2"></textarea>
              </label>
            </div>

            <div className="mt-6 flex flex-wrap gap-3">
              <a onClick={(e)=>{e.preventDefault(); handleDownloadPDF();}} href="#" className="px-4 py-2 rounded-xl bg-black text-white">{t.downloadPDF}</a>
              <a href={emailLink} className="px-4 py-2 rounded-xl border bg-white">{t.emailOrder}</a>
              <div className="inline-flex items-center gap-2 px-4 py-2 rounded-xl border bg-white">
                <span>{t.orCall}</span>
                <a href="tel:+41790000000" className="font-semibold">{t.phone}</a>
              </div>
            </div>
          </div>

          <div className="p-4 md:p-6 rounded-3xl border bg-white/70 shadow-sm">
            <div ref={receiptRef} className="text-sm">
              <div className="font-semibold mb-2">WokRock — {orderType === "package" ? t.orderType.package : t.orderType.ala}</div>
              <ul className="space-y-1">
                {selectionSummaryLines().map((line, i) => (
                  <li key={i}>{line}</li>
                ))}
              </ul>
              <div className="mt-3 border-t pt-2 flex items-center justify-between">
                <span>{t.total}</span>
                <span className="font-semibold">{chf(total)}</span>
              </div>
              <div className="mt-3 text-xs text-gray-500">
                {t.delivery.date}: {deliveryDate || "—"} · {t.delivery.time}: {deliveryTime || "—"}
                <br/>{t.delivery.address}: {address || "—"}
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* FOOTER */}
      <footer className="mt-12 border-t">
        <div className="max-w-6xl mx-auto px-4 py-10 grid md:grid-cols-4 gap-6 text-sm">
          <div>
            <div className="font-bold">WokRock</div>
            <div className="text-gray-600 mt-2">Premium Asian catering for events in Switzerland.</div>
          </div>
          <div>
            <div className="font-semibold mb-2">{t.nav.menu}</div>
            <ul className="space-y-1">
              <li><a href="#builder" className="hover:opacity-70">{t.nav.packages}</a></li>
              <li><a href="#menu" className="hover:opacity-70">{t.nav.menu}</a></li>
            </ul>
          </div>
          <div>
            <div className="font-semibold mb-2">{t.nav.contact}</div>
            <ul className="space-y-1">
              <li><a href="mailto:order@wokrock.ch" className="hover:opacity-70">order@wokrock.ch</a></li>
              <li><a href="tel:+41790000000" className="hover:opacity-70">{t.phone}</a></li>
            </ul>
          </div>
          <div>
            <div className="font-semibold mb-2">Social</div>
            <ul className="space-y-1 text-gray-600">
              <li>Instagram</li>
              <li>Facebook</li>
            </ul>
          </div>
        </div>
        <div className="text-center text-xs text-gray-500 pb-8">© {new Date().getFullYear()} WokRock</div>
      </footer>
    </div>
  );
}
